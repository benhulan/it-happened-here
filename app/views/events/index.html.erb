<h1>Hello world!</h1>
<h3>Welcome, user!!!! </h3>
<h5>Your current neighborhood is .......</h5>
<div id="yourlocation"></div>
<div>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>

<a href="/events/new">Add a Historical Event</a>

<div id = "showEvents"></div>

<script src="http://maps.googleapis.com/maps/api/js?v=3&sensor=false&amp;libraries=places"></script>
<script type="text/javascript">

function initialize() {
     var map = new google.maps.Map(document.getElementById('map'), {
     zoom: 16,
      center: new google.maps.LatLng(37.790841, -122.42),
    });


     if (navigator.geolocation) {
         navigator.geolocation.getCurrentPosition(function (position) {
             initialLocation = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
             map.setCenter(initialLocation);
//api location name
// $(document).ready(function(){
function getLocationName(){
	var url = "http://api.geonames.org/findNearbyPlaceName?lat=" + position.coords.latitude + "&lng=" + position.coords.longitude + "&username=jwyk";
	$.ajax({
		url: url,
		method: 'GET',
	}).done(function(object){
		var xml = object;
	 	var loc= $(xml).find("name").text();
	 	$("#yourlocation").append('<h2>' + loc + '</h2>');
	});
}
// });
//end of ajax
         });



         
     }

        loadData();
        //gon.watch renews data in gon variables!
        gon.watch;

function loadData (){
 gon.locations.forEach(function(location){
    var locationLatLong = new google.maps.LatLng(location.lat, location.lng);
    var marker = new google.maps.Marker({
        position: locationLatLong,
        map: map
    });
    google.maps.event.addListener(marker, 'click', function() {
      $('#showEvents').empty();
      
      gon.quickEvents.forEach(function(e){
        if (e.location_id == location.id) {
          $('#showEvents').slideDown( "slow", function() {
          // Animation complete.

          $('#showEvents').append('<p>' + e.content + '</p>');
        });
          
        } 
      });

      
      // window.location.href = '/locations/' + location.id;
    });

    });
}

 }

google.maps.event.addDomListener(window, 'load', initialize);



</script>